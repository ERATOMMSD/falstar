; incrementally increase number of control points to four
(set-solver adaptive (2 2 3 3 3 4) 0.25 20)

(set-seed 0)
(set-repeat 10)

(define-system
  EMB
    (simulink "src/test/simulink/emb_controller.slx")
    (inputs
      (x_noise -0.001 0.001)
      (R 0.5 0.7)
      (L 0.00095 0.00105))
    (outputs
      (x)
      (v)
      (F)
      (I)
      (br)
      (state))
    (load
      "src/test/simulink/emb_variables.mat"))


(set-system EMB)

(define eps 0.002)
(define x0  0.05)
(define contact (and (< x x0) (eventually (0 0.01) (> x x0))))

(set-log
  "results/ARCH2018/MMSD-FLSTar-EMBa1.csv")
(falsify
  (eventually (0 0.033)
    (always (0 1) (in x (- x0 eps) (+ x0 eps)))))

(set-log
  "results/ARCH2018/MMSD-FLSTar-EMBa2.csv")
(falsify
  (always (0 1)
    (implies contact  (<= v 0.2))))

(set-log
  "results/ARCH2018/MMSD-FLSTar-EMBb2.csv")
(falsify
  (always (0 1)
    (implies (in F 0 500)
             (< (abs I) 2500))))

(set-log
  "results/ARCH2018/MMSD-FLSTar-EMBb4.csv")
(falsify
  (always (0 1)
    (implies (== br 0)
             (eventually (0 0.02) (< F 150)))))

    